"use strict";function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,t=function(){};return{s:t,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,r=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function about_slider(){document.addEventListener("DOMContentLoaded",function(){new Splide("#about_slider",{type:"fade",perPage:1,lazyLoad:"nearby",rewind:!0}).mount()})}function modal_contact(){var t=document.querySelector(".modal-window"),n=t.querySelector(".modal-window__contact"),e=t.querySelector(".remove-btn"),o=document.querySelector("#contact-btn"),r=t.querySelectorAll("input");function c(){n.style.transform="translateY(-100%)",setTimeout(function(){t.classList.remove("modal-contact_active")},400),t.classList.contains("modal-contact_active")&&o.classList.remove("contact-title_active")}o.addEventListener("click",function(e){t.classList.add("modal-contact_active"),setTimeout(function(){n.style.transform="translateY(-5%)"},400),t.classList.contains("modal-contact_active")&&o.classList.add("contact-title_active")}),e.addEventListener("click",function(e){c()}),t.onclick=function(e){e.target===n&&c()},r.forEach(function(t,e){t.onfocus=function(e){e.target.nextElementSibling.classList.add("form-call_focus"),t.style.boxShadow="0em 0em 0.2em 0.15em #F8AF00"},t.onblur=function(e){""!=t.value&&" "!=t.value||(e.target.nextElementSibling.classList.remove("form-call_focus"),t.style.boxShadow="none")}})}function reviews_slider(){document.addEventListener("DOMContentLoaded",function(){var e,t,n=new Splide("#reviews_slider",{perPage:2,pagination:!1,classes:{arrows:"reviews-btns",prev:"reviews-btns__prev",next:"reviews-btns__next"}}).mount();e=document.querySelector("#reviews_slider"),t=e.querySelector(".splide__list"),e=e.querySelectorAll(".splide__slide"),function(o,r){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open(o,r),n.responseType="json",n.onload=function(){(400<=n.status?t:e)(n.response)},n.onerror=function(){t(n.response)},n.send()})}("GET","http://www.sinica-artplace.ru/api/v1/review_list").then(function(e){e.forEach(function(e){n.add('<li class="splide__slide">\n              <p class="text reviews-comment">'.concat(e.text,'</p>\n              <div class="info">\n                <div class="info__img">\n                  <img src="').concat(e.img,'"/>\n                </div>\n                <p class="text info__name">').concat(e.name,"</p>\n              </div>\n            </li>"))})}).catch(function(e){return console.log(e)}),e.forEach(function(e){t.removeChild(e)}),window.matchMedia("(max-width: 860px)").matches?n.options={perPage:1,pagination:!0}:n.options={perPage:2,pagination:!1}})}function basket_modal(){var t=document.querySelector(".basket-modal"),n=t.querySelector(".basket-form"),e=t.querySelector(".basket-remove"),o=document.querySelector("#basket"),r=t.querySelectorAll("input");function c(){n.style.transform="translateX(200%)",setTimeout(function(){t.classList.remove("basket-modal_active")},400),t.classList.contains("basket-modal_active")&&(document.querySelector("body").style.overflow="auto")}o.addEventListener("click",function(e){t.classList.add("basket-modal_active"),setTimeout(function(){n.style.transform="translateX(0%)"},400),t.classList.contains("basket-modal_active")&&(document.querySelector("body").style.overflow="hidden")}),e.addEventListener("click",function(e){c()}),window.onclick=function(e){e.target!=t&&e.target!=t.querySelector(".container")||c()},r.forEach(function(t,e){t.onfocus=function(e){e.target.nextElementSibling.classList.add("basket-inp_focus")},t.onblur=function(e){""!=t.value&&" "!=t.value||e.target.nextElementSibling.classList.remove("basket-inp_focus")}})}about_slider(),modal_contact(),reviews_slider(),basket_modal();var all_price=0;function addCourses(){var c=new Splide("#basket-slider",{pagination:!1,classes:{arrows:"basket-arrows",prev:"basket-arrows__prev",next:"basket-arrows__next"}}).mount(),a=document.querySelector("#basket-slider"),e=document.querySelectorAll(".buy"),i=(document.querySelector(".basket-slider-list"),document.querySelector("#basket-form__all-price"));e.forEach(function(s,e){s.onclick=function(e){var e=e.target.parentNode,n=e.querySelector(".course-card__title").textContent,t=e.querySelector(".card-price").textContent,o=e.querySelector(".card-img").getAttribute("src"),e=a.querySelectorAll(".basket-product__name"),r=!0;e.forEach(function(e,t){if(e.textContent==n)return r=!1}),r?(c.add('<li class="splide__slide basket-product">\n               <div class="basket-product__logo">\n                <img src="'.concat(o,'" class="basket-product__img" />\n               </div>\n               <div class="basket-product__box">\n                <div class="basket-product__name">').concat(n,'</div>\n                <div class="basket-product__price">').concat(t," ₽</div>\n               </div>\n            </li>")),all_price+=Number(t),i.innerHTML="".concat(all_price," ₽"),function(){s.classList.add("_fly");var e=document.querySelector("#basket"),t=(c=s.parentNode.querySelector(".course-card")).cloneNode(!0),n=c.offsetWidth,o=c.offsetHeight,r=c.getBoundingClientRect().top,c=c.getBoundingClientRect().left;t.setAttribute("class","_flyImage"),t.style.cssText="\n              left: ".concat(c,"px;  \n              top: ").concat(r,"px;  \n              height: ").concat(o,"px;  \n              width: ").concat(n,"px;  \n\n            "),document.body.append(t),n=e.getBoundingClientRect().top,e=e.getBoundingClientRect().left,t.style.cssText="\n              left: ".concat(e+50,"px;  \n              top: ").concat(n,"px;   \n              height:0;\n              width: 0;\n              opacity: 0;\n              border-radius:50%;\n            ")}()):l=!0}});var l=!1;setInterval(function(){l&&(modal_ok("Этот элемент уже в корзине"),l=!1)},100)}function basket_req(){var e="https://jsonplaceholder.typicode.com/users";var t=document.querySelector("#basket-phone"),n=document.querySelector("#basket-name"),o=document.querySelector("#basket-mail"),r={user:{name:String,phone:String,mail:String,all_price:Number},courses:[]};function c(){r.name=n.value,r.phone=t.value,r.mail=o.value,r.all_price=all_price,document.querySelectorAll(".basket-product").forEach(function(e){r.courses.push({cousre_name:"".concat(e.querySelector(".basket-product__name").textContent),cousre_img:"".concat(e.querySelector(".basket-product__img").getAttribute("src").split("\\").pop().split("/").pop()),cousre_pice:"".concat(e.querySelector(".basket-product__price").textContent)})}),function(o,r,e){var c=2<arguments.length&&void 0!==e?e:null;return new Promise(function(e,t){var n=new XMLHttpRequest;n.open(o,r),n.responseType="json",n.setRequestHeader("Content-Type","application/json"),n.onload=function(){(400<=n.status?t:e)(n.response)},n.onerror=function(){t(n.response)},n.send(JSON.stringify(c))})}("POST",e,r).then(function(e){return console.log(e)}).catch(function(e){console.log(e)})}var s=document.querySelector("#basket-modal");s.addEventListener("submit",function(e){e.preventDefault(),0===function(){var n=0,e=s.querySelectorAll("._req"),t=s.querySelectorAll(".basket-product");e.forEach(function(e,t){e.nextElementSibling.classList.remove("_error"),""===e.value&&(e.nextElementSibling.classList.add("_error"),n++)}),t.length<1&&(n++,modal_ok("выберите курс"));return n}()&&(c(),s.querySelectorAll("input").forEach(function(e,t){e.value="",e.nextElementSibling.classList.remove("basket-inp_focus")}),function(){var e=s.querySelectorAll(".basket-product"),n=s.querySelector(".basket-slider-list"),t=document.querySelector("#basket-form__all-price");e.forEach(function(e,t){n.removeChild(e)}),all_price=0,t.innerHTML="".concat(all_price," ₽")}())})}function contact__req(){var e="http://www.sinica-artplace.ru/contact_us/leave_request/";var t={name:String,phone_number:String};function n(){t.name=c.value,t.phone_number=r.value,function(o,r,e){var c=2<arguments.length&&void 0!==e?e:null;return new Promise(function(e,t){var n=new XMLHttpRequest;n.open(o,r),n.responseType="json",n.setRequestHeader("Content-Type","application/json"),n.onload=function(){400<=n.status?t(n.response):(e(n.response),modal_ok(n.response.message))},n.onerror=function(){t(n.response)},n.send(JSON.stringify(c))})}("POST",e,t).then(function(e){return console.log(e)}).catch(function(e){console.log(e)})}var o=document.querySelector(".form-call"),r=document.querySelector("#s_contact-phone"),c=document.querySelector("#s_contact-name");o.addEventListener("submit",function(e){e.preventDefault(),0===function(){var n=0;return o.querySelectorAll("._req").forEach(function(e,t){e.style.boxShadow="none",""===e.value&&(e.style.boxShadow="0em 0em 0.2em 0.15em red",n++)}),n}()&&(n(),o.querySelectorAll("input").forEach(function(e,t){e.value="",e.nextElementSibling.classList.remove("form-call_focus")}))})}function sldier_card_functions(){function t(){e.checked?n.classList.remove("hover-type"):n.classList.add("hover-type")}var e,n,o,r;document.querySelectorAll(".courses-flip__btn").forEach(function(t,e){t.addEventListener("click",function(e){t.parentNode.parentNode.parentNode.classList.toggle("card-active")})}),e=document.querySelector("#courses-slider-type"),n=document.querySelector("#courses-slider"),o=document.querySelectorAll(".course-card"),r=document.querySelectorAll(".hover-style__btn"),e.addEventListener("click",function(e){o.forEach(function(e,t){e.classList.remove("card-active")}),t()}),r.forEach(function(t,e){t.addEventListener("click",function(e){t.parentNode.classList.toggle("hover-style_active")})}),window.matchMedia("(max-width: 860px)").matches?e.checked=!1:e.checked=!0,t()}function course_slider(){document.addEventListener("DOMContentLoaded",function(){var e=new Splide("#courses-slider",{perPage:3,pagination:!1,perMove:1,classes:{arrows:"courses-slider__btns",prev:"courses-slider__btns_prev",next:"courses-slider__btns_next"}}).mount();GET_courses(e);var r=!0,c=!1,s=!1,a=0;function t(e){var t=window.matchMedia("(min-width: 1400px)"),n=window.matchMedia("(max-width: 1400px)"),o=window.matchMedia("(max-width: 860px)");t.matches&&(r=!(s=c=!1)),n.matches&&(c=!(s=r=!1)),o.matches&&(s=!(r=c=!1)),r&&(a=3),c&&(a=2),s&&(a=1),e.options={perPage:a}}t(e),window.onresize=function(){t(e)}})}function GET_courses(t){var o,r,e=document.querySelector("#courses-slider"),n=e.querySelector(".splide__list"),e=e.querySelectorAll(".splide__slide");o="GET",r="http://www.sinica-artplace.ru/api/v1/item_list",new Promise(function(e,t){var n=new XMLHttpRequest;n.open(o,r),n.responseType="json",n.onload=function(){(400<=n.status?t:e)(n.response)},n.onerror=function(){t(n.response)},n.send()}).then(function(e){e.forEach(function(e){t.add('<li class="splide__slide">\n           <div class="course-card">\n               <div class="course-card_front">\n                <div class="courses-flip">\n                  <svg class="courses-flip__arrow">\n                    <use xlink:href="./assets/icons/svg/sprite.svg#flip-arrow"></use>\n                  </svg>\n                  <button class="courses-flip__btn">\n                    <svg>\n                      <use xlink:href="./assets/icons/svg/sprite.svg#flip"></use>\n                    </svg>\n                  </button>\n                </div>\n                <div class="course-card__block">\n                  <h3 class="course-card__title">'.concat(e.name,'</h3>\n                  <div class="course-card__img"><img class="card-img" src="http://www.sinica-artplace.ru').concat(e.poster,'"/>\n                  </div>\n                  <div class="course-card__box">\n                    <div class="course-card__author-img"><img class="undefined" src="http://www.sinica-artplace.ru').concat(e.author_img,'"/>\n                    </div>\n                    <div class="course-card__author"><span>автор:</span>\n                      <p>').concat(e.author,'</p>\n                    </div>\n                    <div class="course-card__price"> <span class="card-price">').concat(e.price,'</span><span>₽\n                        <div class="hover-style">\n                          <button class="hover-style__btn">подробнее\n                            <svg>\n                              <use xlink:href="./assets/icons/svg/sprite.svg#hover_arrow"></use>\n                            </svg>\n                          </button>\n                          <div class="hover-style__cont"> \n                            <p class="text">').concat(e.description,'</p>\n                          </div>\n                        </div></span></div>\n                  </div>\n                </div>\n              </div>\n              <div class="course-card_back"> \n                <p class="text" >\n                  ').concat(e.description,'\n                </p>\n                <div class="courses-flip">\n                  <button class="courses-flip__btn">\n                    <svg>\n                      <use xlink:href="./assets/icons/svg/sprite.svg#flip"></use>\n                    </svg>\n                  </button>\n                </div>\n              </div>\n           </div>\n           <button class="btn btn_green buy">\n              купить\n              <svg><use xlink:href="./assets/icons/svg/sprite.svg#basket"></use></svg>\n           </button>\n          </li> '))}),sldier_card_functions()}).then(function(){addCourses()}).catch(function(e){return console.log(e)}),e.forEach(function(e){n.removeChild(e)})}function hamburger(){var n=document.querySelector(".hamburger"),e=document.querySelector(".hamburger-menu"),t=document.querySelectorAll(".hamburger-menu__list__el"),o=document.querySelector(".header").querySelector(".btn");n.onclick=function(){n.classList.toggle("active-burger")},setInterval(function(){n.classList.contains("active-burger")?(o.classList.add("blur"),e.classList.add("hamburger-menu_active")):(o.classList.remove("blur"),e.classList.remove("hamburger-menu_active"))},100),t.forEach(function(e,t){e.onclick=function(){n.classList.remove("active-burger")}})}function header_fix(){var e=document.querySelector(".header");window.onscroll=function(){200<window.pageYOffset?e.classList.add("header_fixed"):e.classList.remove("header_fixed")}}function basket_el_count(){var t=document.querySelector("#basket-el-count");setInterval(function(){var e=document.querySelectorAll(".basket-product");0<e.length?(t.style.display="block",t.textContent=e.length):t.style.display="none"},100)}function anchors(){var e,t=_createForOfIteratorHelper(document.querySelectorAll("a[href*='#']"));try{for(t.s();!(e=t.n()).done;)!function(){var t=e.value;t.addEventListener("click",function(e){e.preventDefault();e=t.getAttribute("href");document.querySelector(""+e).scrollIntoView({behavior:"smooth",block:"start"})})}()}catch(e){t.e(e)}finally{t.f()}}function init(){var e=new ymaps.Map("map",{center:[59.915585,30.317665],zoom:13,controls:["zoomControl"],behaviors:["drag"]}),t=new ymaps.Placemark([59.915585,30.317665],{balloonContent:"Московский поспект, 25/1, Санкт-Петербург"});e.geoObjects.add(t)}function modal_ok(e){var t=document.querySelector(".modal_ok"),n=t.querySelector(".btn"),o=t.querySelector(".title");function r(){t.classList.remove("modal_ok_active"),o.textContent=""}t.classList.add("modal_ok_active"),o.textContent=e,n.addEventListener("click",function(e){r()}),window.onclick=function(e){e.target!=o&&e.target!=t&&r()}}function preloading(){window.onload=function(){document.querySelector(".loader").style.display="none"}}basket_req(),contact__req(),course_slider(),hamburger(),header_fix(),basket_el_count(),anchors(),ymaps.ready(init),preloading();